"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[4546],{17379:function(W,v,n){n.d(v,{r:function(){return C}});var m=n(32735),E=n(72850),b=n(60216),I=n.n(b),K=n(74506);function x(M,O,p){if(!M||!O)return{display:"none"};const{x:A,y:U}=p;return{transform:`translate(${A}px, ${U}px)`}}function C({renderItem:M}){const{itemType:O,isDragging:p,item:A,initialOffset:U,currentOffset:Z,mouseOffset:Y}=(0,K.useDragLayer)(L=>({item:L.getItem(),itemType:L.getItemType(),initialOffset:L.getInitialSourceClientOffset(),currentOffset:L.getSourceClientOffset(),isDragging:L.isDragging(),mouseOffset:L.getClientOffset()}));return p?m.createElement(E.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%"},m.createElement(E.x,{style:x(U,Z,Y)},M({type:O,item:A}))):null}C.propTypes={renderItem:I().func.isRequired}},75430:function(W,v,n){var m=n(32735);const E=(0,m.createContext)();var b=null},69242:function(W,v,n){n.d(v,{PL:function(){return K},Y9:function(){return x.Y},zE:function(){return ae},Ky:function(){return X},fi:function(){return re},zH:function(){return de},r5:function(){return o}});var m=n(32735),E=n(15062),b=n(53634),K=()=>{const e=(0,E.v9)(b.Z),s=(0,m.useCallback)(t=>e?.components?.[t]??{},[e]);return{...e,getComponentLayout:s}},x=n(77622),C=n(19565),M=n(84306),O=n(20716),p=n(97889);const A={error:null,isLoading:!0,layout:{},layouts:{}};var Z=(e,s)=>(0,p.ZP)(e,t=>{switch(s.type){case"GET_DATA":{t.isLoading=!0,t.error=null,t.layout={};break}case"GET_DATA_SUCCEEDED":{const i=s.data.contentType.uid;t.layout=s.data,t.layouts[i]=s.data,t.isLoading=!1;break}case"GET_DATA_ERROR":{t.isLoading=!1,t.error=s.error;break}case"SET_LAYOUT_FROM_STATE":{t.error=null,t.layout=e.layouts[s.uid];break}case"UPDATE_LAYOUT":{const i=e.layout;t.layout={...i,contentType:{uid:i.contentType.uid,...s.newLayout.contentType}},t.layouts[i.contentType.uid]={...i,contentType:{uid:i.contentType.uid,...s.newLayout.contentType}};break}default:return t}}),Y=n(99381),L=n.n(Y),q=n(33795),P=n.n(q),oe=n(3040),S=n.n(oe),_=n(69997);const Q=(e,s)=>s.find(t=>t.uid===e),ie=(e,s)=>{const t=ee(e,s),i=k(t.contentType,s),f=te(t.contentType,t.components);return S()(t,["contentType","layouts","edit"],i),S()(t,["contentType","layouts","list"],f),Object.keys(t.components).forEach(l=>{const g=k(t.components[l],s);S()(t,["components",l,"layouts","edit"],g)}),t},ee=(e,s)=>{const t=(0,_.w8)(L()(e),s,"contentType"),{components:i,contentType:f}=t,l=g=>Object.keys(g.metadatas).reduce((h,R)=>{const N=P()(g,["attributes",R],{});let F=g.metadatas[R];if(N.type==="relation"){const ye=Q(N.targetModel,s),j=F.edit.mainField,G={name:j,schema:P()(ye,["attributes",j])};F={list:{...F.list,mainField:G},edit:{...F.edit,mainField:G}}}return h[R]=F,h},{});return S()(t,["contentType","metadatas"],l(f)),Object.keys(i).forEach(g=>{const h=i[g],R=l(h);S()(t,["components",g,"metadatas"],R)}),t},k=(e,s)=>e.layouts.edit.reduce((t,i)=>{const f=i.map(l=>{const g=P()(e,["attributes",l.name],{}),h={...l,fieldSchema:g,metadatas:P()(e,["metadatas",l.name,"edit"],{})};if(g.type==="relation"){const N=Q(g.targetModel,s).pluginOptions||{};S()(h,"targetModelPluginOptions",N),S()(h,"queryInfos",{shouldDisplayRelationLink:z(e,l.name,s)})}return h});return t.push(f),t},[]),te=(e,s)=>e.layouts.list.reduce((i,f)=>{const l=P()(e,["attributes",f],{}),g=P()(e,["metadatas",f,"list"],{}),h=l.type;if(h==="relation")return i.push({key:`__${f}_key__`,name:f,fieldSchema:l,metadatas:g}),i;if(h==="component"){const R=s[l.component],N=R.settings.mainField,F=R.attributes[N];return i.push({key:`__${f}_key__`,name:f,fieldSchema:l,metadatas:{...g,mainField:{...F,name:N}}}),i}return i.push({key:`__${f}_key__`,name:f,fieldSchema:l,metadatas:g}),i},[]),z=(e,s,t)=>{const i=P()(e,["attributes",s,"targetModel"],"");return B(t).includes(i)},B=e=>e.filter(s=>s.isDisplayed).map(({uid:s})=>s);var V=ie,ae=e=>{const[{error:s,isLoading:t,layout:i,layouts:f},l]=(0,m.useReducer)(Z,A),g=(0,m.useMemo)(O.Vo,[]),{schemas:h}=(0,E.v9)(j=>g(j),E.wU),R=(0,m.useRef)(!0),{get:N}=(0,C.kY)(),F=(0,m.useCallback)(async(j,G)=>{if(f[j]){l({type:"SET_LAYOUT_FROM_STATE",uid:j});return}l({type:"GET_DATA"});try{const{data:{data:se}}=await N(`/content-manager/content-types/${j}/configuration`,{cancelToken:G.token});l({type:"GET_DATA_SUCCEEDED",data:V(se,h)})}catch(se){if(M.default.isCancel(se))return;R.current&&console.error(se),R.current&&l({type:"GET_DATA_ERROR",error:se})}},[f,h,N]);(0,m.useEffect)(()=>()=>{R.current=!1},[]),(0,m.useEffect)(()=>{const G=M.default.CancelToken.source();return F(e,G),()=>{G.cancel("Operation canceled by the user.")}},[e,F]);const ye=(0,m.useCallback)(j=>{l({type:"UPDATE_LAYOUT",newLayout:V(j,h)})},[h]);return{error:s,isLoading:t,layout:i,updateLayout:ye}},ge=e=>e["content-manager_app"].collectionTypeLinks,ce=n(85973),T=n.n(ce),H=n(33348);const ue=(e,s)=>Object.keys(e).reduce((t,i)=>{const f=e[i],l=P()(s,[i],f);return T()(f)?{...t,[i]:ue(f,l)}:(t[i]=l,t)},{});var le=(e,s,t)=>{const i=e.find(({to:F})=>F.includes(s));if(!i)return"/";const{to:f,search:l}=i,g=(0,H.parse)(l),h=(0,H.parse)(t.substring(1)),R=ue(g,h);return`${f}?${(0,H.stringify)(R,{encode:!1})}`},X=e=>{const[{rawQuery:s}]=(0,C.Kx)(),t=(0,E.v9)(ge);return le(t,e,s)},Te=n(15655),$=n(53038),re=()=>{const{search:e}=(0,$.TH)(),s=e?(0,H.parse)(e.substring(1)):{};return s.plugins?(0,H.stringify)({plugins:s.plugins},{encode:!1}):""};const de=e=>{const s=(0,m.useRef)();return(0,m.useEffect)(()=>{s.current=e},[e]),s.current};var J=n(85149);const fe=(e,s,t)=>({type:J.m,permissions:e,__meta__:{plugins:s,containerName:t}}),me=()=>({type:J.Q}),r=e=>e["content-manager_rbacManager"].permissions,u=e=>e.rbacProvider.collectionTypesRelatedPermissions;var o=(e,s,t="listView")=>{const i=(0,E.v9)(u),f=(0,E.v9)(r),l=(0,E.I0)(),g=i[s];return(0,m.useEffect)(()=>g?(l(fe(g,e?e.plugins:null,t)),()=>{l(me())}):()=>{},[g,l,e,t]),f},d=n(75430);const y=()=>useContext(WysiwygContext);var c=null},77622:function(W,v,n){n.d(v,{Y:function(){return K}});var m=n(32735),E=n(74506),b=n.n(E),I=n(15655);const K=(x,{type:C="STRAPI_DND",index:M,item:O={},onStart:p,onEnd:A,onGrabItem:U,onDropItem:Z,onCancel:Y,onMoveItem:L,dropSensitivity:q="regular"})=>{const P=(0,m.useRef)(null),[{handlerId:oe},S]=(0,E.useDrop)({accept:C,collect(k){return{handlerId:k.getHandlerId()}},hover(k,te){if(!P.current)return;const z=k.index,B=M;if(z!==B){if(q==="regular"){const V=P.current.getBoundingClientRect(),ne=(V.bottom-V.top)/2,w=te.getClientOffset().y-V.top;if(z<B&&w<ne||z>B&&w>ne)return}L(B,z),k.index=B}}}),[{isDragging:_},Q,ie]=(0,E.useDrag)({type:C,item(){p&&p();const{width:k}=P.current?.getBoundingClientRect()??{};return{index:M,width:k,...O}},end(){A&&A()},canDrag:x,isDragging:O.id?k=>O.id===k.getItem().id:void 0,collect:k=>({isDragging:k.isDragging()})}),ee=(0,I.A)(x,M,{onGrabItem:U,onDropItem:Z,onCancel:Y,onMoveItem:L});return[{handlerId:oe,isDragging:_,handleKeyDown:ee},P,S,Q,ie]}},15655:function(W,v,n){n.d(v,{A:function(){return E}});var m=n(32735);const E=(b,I,{onCancel:K,onDropItem:x,onGrabItem:C,onMoveItem:M})=>{const[O,p]=(0,m.useState)(!1),A=L=>{O&&(L==="UP"?M(I-1,I):L==="DOWN"&&M(I+1,I))},U=()=>{O?(x&&x(I),p(!1)):(C&&C(I),p(!0))},Z=()=>{O&&(p(!1),K&&K(I))};return L=>{if(b&&!(L.key==="Tab"&&!O))switch(L.preventDefault(),L.key){case" ":case"Enter":U();break;case"Escape":Z();break;case"ArrowDown":case"ArrowRight":A("DOWN");break;case"ArrowUp":case"ArrowLeft":A("UP");break;default:}}}},20716:function(W,v,n){n.d(v,{Jg:function(){return M},KQ:function(){return x},Vo:function(){return C},Yg:function(){return b}});var m=n(98178),E=n(60371);const b=()=>p=>p["content-manager_app"]||E.E,I=()=>createSelector(b(),p=>p),K=()=>createSelector(b(),p=>p.models),x=()=>(0,m.P1)(b(),p=>({collectionTypeLinks:p.collectionTypeLinks,singleTypeLinks:p.singleTypeLinks})),C=()=>(0,m.P1)(b(),({components:p,models:A})=>({schemas:[...p,...A]})),M=(0,m.P1)(b(),p=>p.fieldSizes);var O=null},53634:function(W,v){const n=m=>m["content-manager_editViewLayoutManager"].currentLayout;v.Z=n},24381:function(W,v){v.Z={COMPONENT:"component",EDIT_FIELD:"editField",FIELD:"field",DYNAMIC_ZONE:"dynamicZone",RELATION:"relation"}},7921:function(W,v){const n=m=>`content-manager.${m}`;v.Z=n},69997:function(W,v,n){n.d(v,{_Q:function(){return B.Z},W3:function(){return I},ko:function(){return x},FE:function(){return M},Di:function(){return U},Ex:function(){return me},du:function(){return q},TA:function(){return S},Ts:function(){return ee},Uo:function(){return te},OB:function(){return z.Z},w8:function(){return ce},kc:function(){return ue}});var m=n(99381),E=n.n(m),I=(r,u,a)=>{if(Array.isArray(r)&&u>=0&&a>=0&&u<=r.length-1&&a<=r.length-1){const o=E()(r),d=o.splice(u,1);return o.splice(a,0,d[0]),o}return r},x=r=>{const{type:u}=r;return u==="relation"?!(r?.relationType??"").toLowerCase().includes("morph"):!["json","dynamiczone","richtext","password"].includes(u)&&!!u};const C=(r,u)=>{typeof r=="function"?r(u):r!=null&&(r.current=u)},M=(...r)=>u=>r.forEach(a=>C(a,u));var O=n(33795),p=n.n(O);const A=(r,u)=>Object.keys(r).reduce((a,o)=>{const d=p()(r,[o],{}),{default:y,component:c,type:e,required:s,min:t,repeatable:i}=d;if(y!==void 0&&(a[o]=y),e==="component"){const f=u?.[c]?.attributes??{},l=A(f,u);if(s===!0&&(a[o]=i===!0?[]:l),t&&i===!0&&s){a[o]=[];for(let g=0;g<t;g+=1)a[o].push(l)}}return e==="dynamiczone"&&s===!0&&(a[o]=[]),a},{});var U=A,Z=n(9086),Y=n.n(Z),q=({layouts:r,metadatas:u,...a})=>{const o=r.list.map(c=>c.name?c.name:c),d=Object.keys(u).reduce((c,e)=>{const s=p()(u,[e],{});let t=s.edit;return t.mainField&&(t={...t,mainField:s.edit.mainField.name}),{...c,[e]:{edit:t,list:Y()(s.list,["mainField"])}}},{}),y=r.edit.map(c=>c.map(({name:e,size:s})=>({name:e,size:s})));return{...a,layouts:{edit:y,list:o},metadatas:d}};const P=(r,u)=>r.map(a=>({...a,subject:u}));var S=r=>{const u={create:[{action:"plugin::content-manager.explorer.create",subject:null}],delete:[{action:"plugin::content-manager.explorer.delete",subject:null}],publish:[{action:"plugin::content-manager.explorer.publish",subject:null}],read:[{action:"plugin::content-manager.explorer.read",subject:null}],update:[{action:"plugin::content-manager.explorer.update",subject:null}]};return Object.keys(u).reduce((a,o)=>(a[o]=P(u[o],r),a),{})},_=n(95919),Q=n.n(_),ee=r=>r.split(".").filter(u=>Q()(parseInt(u,10))),te=r=>{if(r.length===0)return-1;const u=Math.max.apply(Math,r.map(a=>a.__temp_key__??0));return Number.isNaN(u)?-1:u},z=n(7921),B=n(24381),V=n(86349),ne=n.n(V),ae=n(3040),w=n.n(ae),ce=(r,u,a)=>{const o=e=>u.find(s=>s.uid===e),d=Object.assign({},r),y=r[a].uid,c=o(y);return w()(d,[a],ne()({},c,r[a])),Object.keys(r.components).forEach(e=>{const s=o(e);w()(d,["components",e],{...r.components[e],...s})}),d},T=n(19565),ue=(r,u,a)=>{const o=(d,y)=>Object.keys(d).reduce((c,e)=>{const s=(0,T.UN)(y,e),t=p()(d,e),i=(0,T.k2)(y,[e,"component"]),f=(0,T.k2)(y,[e,"repeatable"]);return s==="dynamiczone"?(c[e]=t.map(l=>o(l,a[l.__component])),c):s==="component"?(f?c[e]=t&&t.map(l=>o(l,a[i])):c[e]=t&&o(t,a[i]),c):(s!=="password"&&(c[e]=t),c)},{});return o(r,u)},pe=n(51355),le=n.n(pe),he=n(86834),X=n.n(he),Te=n(78746),$=n.n(Te),D=n(24346),re=n(73347);D.kM(D.nK,"defined",function(){return this.test("defined",T.I0.required,r=>r!==void 0)}),D.kM(D.IX,"notEmptyMin",function(r){return this.test("notEmptyMin",T.I0.min,u=>X()(u)?!0:u.length>=r)}),D.kM(D.Z_,"isInferior",function(r,u){return this.test("isInferior",r,function(a){return!a||Number.isNaN($()(a))?!0:$()(u)>=$()(a)})}),D.kM(D.Z_,"isSuperior",function(r,u){return this.test("isSuperior",r,function(a){return!a||Number.isNaN($()(a))?!0:$()(a)>=$()(u)})});const de=r=>p()(r,["attributes"],{}),J=(r,{components:u},a={isCreatingEntry:!0,isDraft:!0,isFromComponent:!1})=>{const o=de(r);return D.Ry().shape(Object.keys(o).reduce((d,y)=>{const c=o[y];if(c.type!=="relation"&&c.type!=="component"&&c.type!=="dynamiczone"){const e=fe(c.type,c,a);d[y]=e}if(c.type==="relation"&&(d[y]=["oneWay","oneToOne","manyToOne","oneToManyMorph","oneToOneMorph"].includes(c.relationType)?D.Ry().nullable():D.IX().nullable()),c.type==="component"){const e=J(u[c.component],{components:u},{...a,isFromComponent:!0});if(c.repeatable===!0){const{min:t,max:i,required:f}=c;let l=D.Vo(g=>{let h=D.IX().of(e);return t?f?h=h.min(t,T.I0.min):f!==!0&&X()(g)?h=h.nullable():h=h.min(t,T.I0.min):f&&!a.isDraft&&(h=h.min(1,T.I0.required)),i&&(h=h.max(i,T.I0.max)),h});return d[y]=l,d}const s=D.Vo(t=>t!==void 0?c.required===!0&&!a.isDraft?e.defined():e.nullable():c.required===!0?D.Ry().defined():D.Ry().nullable());return d[y]=s,d}if(c.type==="dynamiczone"){let e=D.IX().of(D.Vo(({__component:i})=>J(u[i],{components:u},{...a,isFromComponent:!0})));const{max:s,min:t}=c;t?c.required?e=e.test("min",T.I0.min,i=>a.isCreatingEntry?i&&i.length>=t:i===void 0?!0:i!==null&&i.length>=t).test("required",T.I0.required,i=>a.isCreatingEntry?i!==null||i!==void 0:i===void 0?!0:i!==null):e=e.notEmptyMin(t):c.required&&!a.isDraft&&(e=e.test("required",T.I0.required,i=>a.isCreatingEntry?i!==null||i!==void 0:i===void 0?!0:i!==null)),s&&(e=e.max(s,T.I0.max)),d[y]=e}return d},{}))},fe=(r,u,a)=>{let o=D.nK();return["string","uid","text","richtext","email","password","enumeration"].includes(r)&&(o=D.Z_()),r==="json"&&(o=D.nK(T.I0.json).test("isJSON",T.I0.json,d=>{if(!d||!d.length)return!0;try{return JSON.parse(d),!0}catch{return!1}}).nullable().test("required",T.I0.required,d=>!(u.required&&(!d||!d.length)))),r==="email"&&(o=o.email(T.I0.email)),["number","integer","float","decimal"].includes(r)&&(o=D.Rx().transform(d=>Q()(d)?void 0:d).typeError()),r==="biginteger"&&(o=D.Z_().matches(/^-?\d*$/)),["date","datetime"].includes(r)&&(o=D.hT()),Object.keys(u).forEach(d=>{const y=u[d];if(y||!le()(y)&&Number.isInteger(Math.floor(y))||y===0)switch(d){case"required":{a.isDraft||(r==="password"&&a.isCreatingEntry&&(o=o.required(T.I0.required)),r!=="password"&&(a.isCreatingEntry?o=o.required(T.I0.required):o=o.test("required",T.I0.required,c=>c===void 0&&!a.isFromComponent?!0:(0,re.Z)(r)?c===0?!0:!!c:r==="boolean"?c!=null:r==="date"||r==="datetime"?typeof c=="string"?!X()(c):!X()(c?.toString()):!X()(c))));break}case"max":{r==="biginteger"?o=o.isInferior(T.I0.max,y):o=o.max(y,T.I0.max);break}case"maxLength":o=o.max(y,T.I0.maxLength);break;case"min":{r==="biginteger"?o=o.isSuperior(T.I0.min,y):o=o.min(y,T.I0.min);break}case"minLength":{a.isDraft||(o=o.min(y,T.I0.minLength));break}case"regex":o=o.matches(new RegExp(y),{message:T.I0.regex,excludeEmptyString:!u.required});break;case"lowercase":["text","textarea","email","string"].includes(r)&&(o=o.strict().lowercase());break;case"uppercase":["text","textarea","email","string"].includes(r)&&(o=o.strict().uppercase());break;case"positive":(0,re.Z)(r)&&(o=o.positive());break;case"negative":(0,re.Z)(r)&&(o=o.negative());break;default:o=o.nullable()}}),o};var me=J},73347:function(W,v,n){n.d(v,{Z:function(){return m}});function m(E){return["integer","biginteger","decimal","float","number"].includes(E)}}}]);
